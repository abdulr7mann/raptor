# =============================================================================
# Raptor - Configuration Example
# =============================================================================
# Copy this file to pentest.yaml and fill in your values:
#   cp pentest.example.yaml pentest.yaml
# =============================================================================

# Input: path to Postman collection OR Swagger/OpenAPI spec
input_file: "./swagger.json"  # or "./collection.json"

# Optional: Postman environment file (resolves {{variables}})
# environment_file: "./my_env.postman_environment.json"

# Base URL override (overrides whatever is in the spec/collection)
base_url: "https://api.target.com"

# -----------------------------------------------------------------------------
# OAuth2 Configuration
# -----------------------------------------------------------------------------
oauth2:
  token_url: "https://api.target.com/oauth/token"
  grant_type: "client_credentials"  # or "password"
  client_id: "your-client-id"
  client_secret: "your-client-secret"
  # For password grant type:
  username: "user@example.com"
  password: "your-password"
  scopes: []

# Second user for IDOR and privilege escalation tests
# (Tests if user_b can access user_a's resources)
user_b:
  client_id: "second-client-id"
  client_secret: "second-client-secret"
  username: "user2@example.com"
  password: "user2-password"

# -----------------------------------------------------------------------------
# Scenarios to run (empty list = all scenarios)
# -----------------------------------------------------------------------------
# Available: s01, s02, s03, s04, s05, s06, s07, s08, s09, s10, s11, s12, s13
scenarios: []

# Run only specific scenarios:
# scenarios:
#   - s01  # Token Reuse
#   - s03  # IDOR
#   - s07  # Access Controls

# -----------------------------------------------------------------------------
# Rate Limiting Configuration (S02)
# -----------------------------------------------------------------------------
rate_limit:
  requests_per_burst: 50
  window_seconds: 10

# -----------------------------------------------------------------------------
# HTTP Client Settings
# -----------------------------------------------------------------------------
timeout: 30
max_retries: 0
verify_ssl: false  # Set to true for production APIs with valid certs

# -----------------------------------------------------------------------------
# Output
# -----------------------------------------------------------------------------
output_dir: "./reports"

# -----------------------------------------------------------------------------
# Adaptive Testing Options
# -----------------------------------------------------------------------------
# relevance_threshold: 0.3  # Min relevance score (0.0-1.0) to run a test
# fast: false               # If true, raises threshold to 0.6 for quicker scans
